!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((t="undefined"!=typeof globalThis?globalThis:t||self).cryptico={})}(this,(function(t){"use strict";const s={Sbox:[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],ShiftRowTab:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],Sbox_Inv:new Array(256),ShiftRowTab_Inv:new Array(16),xtime:new Array(256),Init(){for(let t=0;t<256;t++)this.Sbox_Inv[this.Sbox[t]]=t;for(let t=0;t<16;t++)this.ShiftRowTab_Inv[this.ShiftRowTab[t]]=t;for(let t=0;t<128;t++)this.xtime[t]=t<<1,this.xtime[128+t]=t<<1^27},Done(){this.Sbox_Inv.length=0,this.Sbox_Inv.length=256,this.ShiftRowTab_Inv.length=0,this.ShiftRowTab_Inv.length=16,this.xtime.length=0,this.xtime.length=256},ExpandKey(t){const i=t.length;let e,r=1;switch(i){case 16:e=176;break;case 24:e=208;break;case 32:e=240;break;default:throw"my.ExpandKey: Only key lengths of 16, 24 or 32 bytes allowed!"}for(let n=i;n<e;n+=4){let e=t.slice(n-4,n);n%i==0?(e=[s.Sbox[e[1]]^r,s.Sbox[e[2]],s.Sbox[e[3]],s.Sbox[e[0]]],(r<<=1)>=256&&(r^=283)):i>24&&n%i==16&&(e=[s.Sbox[e[0]],s.Sbox[e[1]],s.Sbox[e[2]],s.Sbox[e[3]]]);for(let s=0;s<4;s++)t[n+s]=t[n+s-i]^e[s]}},Encrypt(t,i){const e=i.length;let r;for(s.AddRoundKey(t,i.slice(0,16)),r=16;r<e-16;r+=16)s.SubBytes(t,s.Sbox),s.ShiftRows(t,s.ShiftRowTab),s.MixColumns(t),s.AddRoundKey(t,i.slice(r,r+16));s.SubBytes(t,s.Sbox),s.ShiftRows(t,s.ShiftRowTab),s.AddRoundKey(t,i.slice(r,e))},Decrypt(t,i){const e=i.length;s.AddRoundKey(t,i.slice(e-16,e)),s.ShiftRows(t,s.ShiftRowTab_Inv),s.SubBytes(t,s.Sbox_Inv);for(let r=e-32;r>=16;r-=16)s.AddRoundKey(t,i.slice(r,r+16)),s.MixColumns_Inv(t),s.ShiftRows(t,s.ShiftRowTab_Inv),s.SubBytes(t,s.Sbox_Inv);s.AddRoundKey(t,i.slice(0,16))},SubBytes(t,s){for(let i=0;i<16;i++)t[i]=s[t[i]]},AddRoundKey(t,s){for(let i=0;i<16;i++)t[i]^=s[i]},ShiftRows(t,s){const i=(new Array).concat(t);for(let e=0;e<16;e++)t[e]=i[s[e]]},MixColumns(t){for(let i=0;i<16;i+=4){const e=t[i+0],r=t[i+1],n=t[i+2],o=t[i+3],h=e^r^n^o;t[i+0]^=h^s.xtime[e^r],t[i+1]^=h^s.xtime[r^n],t[i+2]^=h^s.xtime[n^o],t[i+3]^=h^s.xtime[o^e]}},MixColumns_Inv(t){for(let i=0;i<16;i+=4){const e=t[i+0],r=t[i+1],n=t[i+2],o=t[i+3],h=e^r^n^o,c=s.xtime[h],u=s.xtime[s.xtime[c^e^n]]^h,l=s.xtime[s.xtime[c^r^o]]^h;t[i+0]^=u^s.xtime[e^r],t[i+1]^=l^s.xtime[r^n],t[i+2]^=u^s.xtime[n^o],t[i+3]^=l^s.xtime[o^e]}}},i=[],e=256,r=Math.pow(2,52),n=2*r,o=Math.pow(e,6),h={seedrandom(t,s=!1){const f=[];t=l(u(s?[t,i]:arguments.length?t:[(new Date).getTime(),i],3),f);const a=new c(f);return l(a.S,i),h.random=function(){let t=a.g(6),s=o,i=0;for(;t<r;)t=(t+i)*e,s*=e,i=a.g(1);for(;t>=n;)t/=2,s/=2,i>>>=1;return(t+i)/s},t},random:function(){return Math.random()}};class c{constructor(t){this.i=0,this.j=0,this.S=[],this.c=[];let s,i,r=t.length,n=0,o=0;for(r||(t=[r++]);n<e;)this.S[n]=n++;for(n=0;n<e;n++)s=this.S[n],o=f(o+s+t[n%r]),i=this.S[o],this.S[n]=i,this.S[o]=s;this.g(e)}g(t){const s=this.S;let i=f(this.i+1),r=s[i],n=f(this.j+r),o=s[n];s[i]=o,s[n]=r;let h=s[f(r+o)];for(;--t;)i=f(i+1),r=s[i],n=f(n+r),o=s[n],s[i]=o,s[n]=r,h=h*e+s[f(r+o)];return this.i=i,this.j=n,h}}function u(t,s){const i=[],e=typeof t;if(s&&"object"===e)for(const n in t)if(n.indexOf("S")<5)try{i.push(u(t[n],s-1))}catch(r){console.error(r)}return i.length?i:t+("string"!==e?"\0":"")}function l(t,s){const i=t+"";let e=0;for(let n=0;n<i.length;n++)s[f(n)]=f((e^=19*s[f(n)])+i.charCodeAt(n));let r="";return s.forEach((t=>r+=String.fromCharCode(t))),r}function f(t){return 255&t}l(Math.random(),i);class a{nextBytes(t){for(let s=0;s<t.length;s++)t[s]=Math.floor(256*h.random())}}class m{constructor(){this.i=0,this.j=0,this.S=[]}init(t){let s,i,e;for(s=0;s<256;++s)this.S[s]=s;for(i=0,s=0;s<256;++s)i=i+this.S[s]+t[s%t.length]&255,e=this.S[s],this.S[s]=this.S[i],this.S[i]=e;this.i=0,this.j=0}next(){this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255;const t=this.S[this.i];return this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}}let d,p,g=[];function b(){var t;t=(new Date).getTime(),g[p++]^=255&t,g[p++]^=t>>8&255,g[p++]^=t>>16&255,g[p++]^=t>>24&255,p>=256&&(p-=256)}if(!g){let t;for(g=[],p=0;p<256;)t=Math.floor(65536*Math.random()),g[p++]=t>>>8,g[p++]=255&t;p=0,b()}function S(){if(!d){for(b(),d=new m,d.init(g),p=0;p<g.length;++p)g[p]=0;p=0}return d.next()}class T{nextBytes(t){let s;for(s=0;s<t.length;++s)t[s]=S()}}const w=(t,s)=>t&s,y=(t,s)=>t|s,v=(t,s)=>t^s,D=(t,s)=>t&~s,x=class{constructor(t,s,i){this.s=0,this.t=0,t&&("number"==typeof t?s?this.fromNumber(t,s,i):this.fromInt(t):this.fromString(t,s||256))}am(t,s,i,e,r,n){const o=32767&s,h=s>>15;for(;--n>=0;){let s=32767&this[t];const n=this[t++]>>15,c=h*s+n*o;s=o*s+((32767&c)<<15)+i[e]+(1073741823&r),r=(s>>>30)+(c>>>15)+h*n+(r>>>30),i[e++]=1073741823&s}return r}copyTo(t){for(let s=this.t-1;s>=0;--s)t[s]=this[s];t.t=this.t,t.s=this.s}fromInt(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+x.DV:this.t=0}fromString(t,s){let i;if(16===s)i=4;else if(8===s)i=3;else if(256===s)i=8;else if(2===s)i=1;else if(32===s)i=5;else{if(4!==s)return void this.fromRadix(t,s);i=2}this.t=0,this.s=0;let e=t.length,r=!1,n=0;for(;--e>=0;){const s=8===i?t[e]:M(t,e);s<0?"-"===t.charAt(e)&&(r=!0):(r=!1,0===n?this[this.t++]=s:n+i>x.DB?(this[this.t-1]|=(s&(1<<x.DB-n)-1)<<n,this[this.t++]=s>>x.DB-n):this[this.t-1]|=s<<n,n+=i,n>=x.DB&&(n-=x.DB))}8===i&&0!=(128&t[0])&&(this.s=-1,n>0&&(this[this.t-1]|=(1<<x.DB-n)-1<<n)),this.clamp(),r&&x.ZERO.subTo(this,this)}clamp(){const t=this.s&x.DM;for(;this.t>0&&this[this.t-1]===t;)--this.t}toString(t){if(this.s<0)return"-"+this.negate().toString(t);let s;if(16===t)s=4;else if(8===t)s=3;else if(2===t)s=1;else if(32===t)s=5;else if(64===t)s=6;else{if(4!==t)return this.toRadix(t);s=2}const i=(1<<s)-1;let e,r=!1,n="",o=this.t,h=x.DB-o*x.DB%s;if(o-- >0)for(h<x.DB&&(e=this[o]>>h)>0&&(r=!0,n=E(e));o>=0;)h<s?(e=(this[o]&(1<<h)-1)<<s-h,e|=this[--o]>>(h+=x.DB-s)):(e=this[o]>>(h-=s)&i,h<=0&&(h+=x.DB,--o)),e>0&&(r=!0),r&&(n+=E(e));return r?n:"0"}negate(){const t=new x;return x.ZERO.subTo(this,t),t}abs(){return this.s<0?this.negate():this}compareTo(t){let s=this.s-t.s;if(0!==s)return s;let i=this.t;if(s=i-t.t,0!==s)return s;for(;--i>=0;)if(0!=(s=this[i]-t[i]))return s;return 0}bitLength(){return this.t<=0?0:x.DB*(this.t-1)+I(this[this.t-1]^this.s&x.DM)}dlShiftTo(t,s){let i;for(i=this.t-1;i>=0;--i)s[i+t]=this[i];for(i=t-1;i>=0;--i)s[i]=0;s.t=this.t+t,s.s=this.s}drShiftTo(t,s){for(let i=t;i<this.t;++i)s[i-t]=this[i];s.t=Math.max(this.t-t,0),s.s=this.s}lShiftTo(t,s){const i=t%x.DB,e=x.DB-i,r=(1<<e)-1,n=Math.floor(t/x.DB);let o,h=this.s<<i&x.DM;for(o=this.t-1;o>=0;--o)s[o+n+1]=this[o]>>e|h,h=(this[o]&r)<<i;for(o=n-1;o>=0;--o)s[o]=0;s[n]=h,s.t=this.t+n+1,s.s=this.s,s.clamp()}rShiftTo(t,s){s.s=this.s;const i=Math.floor(t/x.DB);if(i>=this.t)return void(s.t=0);const e=t%x.DB,r=x.DB-e,n=(1<<e)-1;s[0]=this[i]>>e;for(let o=i+1;o<this.t;++o)s[o-i-1]|=(this[o]&n)<<r,s[o-i]=this[o]>>e;e>0&&(s[this.t-i-1]|=(this.s&n)<<r),s.t=this.t-i,s.clamp()}subTo(t,s){const i=Math.min(t.t,this.t);let e=0,r=0;for(;e<i;)r+=this[e]-t[e],s[e++]=r&x.DM,r>>=x.DB;if(t.t<this.t){for(r-=t.s;e<this.t;)r+=this[e],s[e++]=r&x.DM,r>>=x.DB;r+=this.s}else{for(r+=this.s;e<t.t;)r-=t[e],s[e++]=r&x.DM,r>>=x.DB;r-=t.s}s.s=r<0?-1:0,r<-1?s[e++]=x.DV+r:r>0&&(s[e++]=r),s.t=e,s.clamp()}multiplyTo(t,s){const i=this.abs(),e=t.abs();let r=i.t;for(s.t=r+e.t;--r>=0;)s[r]=0;for(r=0;r<e.t;++r)s[r+i.t]=i.am(0,e[r],s,r,0,i.t);s.s=0,s.clamp(),this.s!==t.s&&x.ZERO.subTo(s,s)}squareTo(t){const s=this.abs();let i=t.t=2*s.t;for(;--i>=0;)t[i]=0;for(i=0;i<s.t-1;++i){const e=s.am(i,s[i],t,2*i,0,1);(t[i+s.t]+=s.am(i+1,2*s[i],t,2*i+1,e,s.t-i-1))>=x.DV&&(t[i+s.t]-=x.DV,t[i+s.t+1]=1)}t.t>0&&(t[t.t-1]+=s.am(i,s[i],t,2*i,0,1)),t.s=0,t.clamp()}divRemTo(t,s,i){const e=t.abs();if(e.t<=0)return;const r=this.abs();if(r.t<e.t)return s&&s.fromInt(0),void(i&&this.copyTo(i));i||(i=new x);const n=new x,o=this.s,h=t.s,c=x.DB-I(e[e.t-1]);c>0?(e.lShiftTo(c,n),r.lShiftTo(c,i)):(e.copyTo(n),r.copyTo(i));const u=n.t,l=n[u-1];if(0===l)return;const f=l*(1<<x.F1)+(u>1?n[u-2]>>x.F2:0),a=x.FV/f,m=(1<<x.F1)/f,d=1<<x.F2,p=s||new x;let g=i.t,b=g-u;for(n.dlShiftTo(b,p),i.compareTo(p)>=0&&(i[i.t++]=1,i.subTo(p,i)),x.ONE.dlShiftTo(u,p),p.subTo(n,n);n.t<u;)n[n.t++]=0;for(;--b>=0;){let t=i[--g]===l?x.DM:Math.floor(i[g]*a+(i[g-1]+d)*m);if((i[g]+=n.am(0,t,i,b,0,u))<t)for(n.dlShiftTo(b,p),i.subTo(p,i);i[g]<--t;)i.subTo(p,i)}s&&(i.drShiftTo(u,s),o!==h&&x.ZERO.subTo(s,s)),i.t=u,i.clamp(),c>0&&i.rShiftTo(c,i),o<0&&x.ZERO.subTo(i,i)}mod(t){const s=new x;return this.abs().divRemTo(t,void 0,s),this.s<0&&s.compareTo(x.ZERO)>0&&t.subTo(s,s),s}invDigit(){if(this.t<1)return 0;const t=this[0];if(0==(1&t))return 0;let s=3&t;return s=s*(2-(15&t)*s)&15,s=s*(2-(255&t)*s)&255,s=s*(2-((65535&t)*s&65535))&65535,s=s*(2-t*s%x.DV)%x.DV,s>0?x.DV-s:-s}isEven(){return 0===(this.t>0?1&this[0]:this.s)}exp(t,s){if(t>4294967295||t<1)return x.ONE;const i=s.convert(this);let e=new x,r=new x,n=I(t)-1;for(i.copyTo(e);--n>=0;)if(s.sqrTo(e,r),(t&1<<n)>0)s.mulTo(r,i,e);else{const t=e;e=r,r=t}return s.revert(e)}modPowInt(t,s){let i;return i=t<256||s.isEven()?new q(s):new O(s),this.exp(t,i)}clone(){const t=new x;return this.copyTo(t),t}intValue(){if(this.s<0){if(1===this.t)return this[0]-x.DV;if(0===this.t)return-1}else{if(1===this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-x.DB)-1)<<x.DB|this[0]}byteValue(){return 0===this.t?this.s:this[0]<<24>>24}shortValue(){return 0===this.t?this.s:this[0]<<16>>16}chunkSize(t){return Math.floor(Math.LN2*x.DB/Math.log(t))}signum(){return this.s<0?-1:this.t<=0||1===this.t&&this[0]<=0?0:1}toRadix(t){if(t||(t=10),0===this.signum()||t<2||t>36)return"0";const s=this.chunkSize(t),i=Math.pow(t,s),e=new x(i),r=new x,n=new x;let o="";for(this.divRemTo(e,r,n);r.signum()>0;)o=(i+n.intValue()).toString(t).substr(1)+o,r.divRemTo(e,r,n);return n.intValue().toString(t)+o}fromRadix(t,s){this.fromInt(0),s||(s=10);const i=this.chunkSize(s),e=Math.pow(s,i);let r=!1,n=0,o=0;for(let h=0;h<t.length;++h){const c=M(t,h);c<0?"-"===t.charAt(h)&&0===this.signum()&&(r=!0):(o=s*o+c,++n>=i&&(this.dMultiply(e),this.dAddOffset(o,0),n=0,o=0))}n>0&&(this.dMultiply(Math.pow(s,n)),this.dAddOffset(o,0)),r&&x.ZERO.subTo(this,this)}fromNumber(t,s,i){if("number"==typeof s)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(x.ONE.shiftLeft(t-1),y,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(s);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(x.ONE.shiftLeft(t-1),this);else{const i=[],e=7&t;i.length=1+(t>>3),s.nextBytes(i),e>0?i[0]&=(1<<e)-1:i[0]=0,this.fromString(i,256)}}toByteArray(){const t=[];let s=this.t;t[0]=this.s;let i,e=x.DB-s*x.DB%8,r=0;if(s-- >0)for(e<x.DB&&(i=this[s]>>e)!=(this.s&x.DM)>>e&&(t[r++]=i|this.s<<x.DB-e);s>=0;)e<8?(i=(this[s]&(1<<e)-1)<<8-e,i|=this[--s]>>(e+=x.DB-8)):(i=this[s]>>(e-=8)&255,e<=0&&(e+=x.DB,--s)),0!=(128&i)&&(i|=-256),0===r&&(128&this.s)!=(128&i)&&++r,(r>0||i!==this.s)&&(t[r++]=i);return t}equals(t){return 0===this.compareTo(t)}min(t){return this.compareTo(t)<0?this:t}max(t){return this.compareTo(t)>0?this:t}bitwiseTo(t,s,i){const e=Math.min(t.t,this.t);let r;for(let n=0;n<e;++n)i[n]=s(this[n],t[n]);if(t.t<this.t){r=t.s&x.DM;for(let t=e;t<this.t;++t)i[t]=s(this[t],r);i.t=this.t}else{r=this.s&x.DM;for(let n=e;n<t.t;++n)i[n]=s(r,t[n]);i.t=t.t}i.s=s(this.s,t.s),i.clamp()}and(t){const s=new x;return this.bitwiseTo(t,w,s),s}or(t){const s=new x;return this.bitwiseTo(t,y,s),s}xor(t){const s=new x;return this.bitwiseTo(t,v,s),s}andNot(t){const s=new x;return this.bitwiseTo(t,D,s),s}not(){const t=new x;for(let s=0;s<this.t;++s)t[s]=x.DM&~this[s];return t.t=this.t,t.s=~this.s,t}shiftLeft(t){const s=new x;return t<0?this.rShiftTo(-t,s):this.lShiftTo(t,s),s}shiftRight(t){const s=new x;return t<0?this.lShiftTo(-t,s):this.rShiftTo(t,s),s}getLowestSetBit(){for(let t=0;t<this.t;++t)if(0!==this[t])return t*x.DB+P(this[t]);return this.s<0?this.t*x.DB:-1}bitCount(){const t=this.s&x.DM;let s=0;for(let i=0;i<this.t;++i)s+=N(this[i]^t);return s}testBit(t){const s=Math.floor(t/x.DB);return s>=this.t?0!==this.s:0!=(this[s]&1<<t%x.DB)}changeBit(t,s){const i=x.ONE.shiftLeft(t);return this.bitwiseTo(i,s,i),i}setBit(t){return this.changeBit(t,y)}clearBit(t){return this.changeBit(t,D)}flipBit(t){return this.changeBit(t,v)}addTo(t,s){const i=Math.min(t.t,this.t);let e=0,r=0;for(;e<i;)r+=this[e]+t[e],s[e++]=r&x.DM,r>>=x.DB;if(t.t<this.t){for(r+=t.s;e<this.t;)r+=this[e],s[e++]=r&x.DM,r>>=x.DB;r+=this.s}else{for(r+=this.s;e<t.t;)r+=t[e],s[e++]=r&x.DM,r>>=x.DB;r+=t.s}s.s=r<0?-1:0,r>0?s[e++]=r:r<-1&&(s[e++]=x.DV+r),s.t=e,s.clamp()}add(t){const s=new x;return this.addTo(t,s),s}subtract(t){const s=new x;return this.subTo(t,s),s}multiply(t){const s=new x;return this.multiplyTo(t,s),s}square(){const t=new x;return this.squareTo(t),t}divide(t){const s=new x;return this.divRemTo(t,s,void 0),s}remainder(t){const s=new x;return this.divRemTo(t,void 0,s),s}divideAndRemainder(t){const s=new x,i=new x;return this.divRemTo(t,s,i),[s,i]}dMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}dAddOffset(t,s){if(0!==t){for(;this.t<=s;)this[this.t++]=0;for(this[s]+=t;this[s]>=x.DV;)this[s]-=x.DV,++s>=this.t&&(this[this.t++]=0),++this[s]}}pow(t){return this.exp(t,new K)}multiplyLowerTo(t,s,i){let e,r=Math.min(this.t+t.t,s);for(i.s=0,i.t=r;r>0;)i[--r]=0;for(e=i.t-this.t;r<e;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(e=Math.min(t.t,s);r<e;++r)this.am(0,t[r],i,r,0,s-r);i.clamp()}multiplyUpperTo(t,s,i){--s;let e=i.t=this.t+t.t-s;for(i.s=0;--e>=0;)i[e]=0;for(e=Math.max(s-this.t,0);e<t.t;++e)i[this.t+e-s]=this.am(s-e,t[e],i,0,0,this.t+e-s);i.clamp(),i.drShiftTo(1,i)}modPow(t,s){let i,e,r=t.bitLength(),n=new x(1);if(r<=0)return n;i=r<18?1:r<48?3:r<144?4:r<768?5:6,e=r<8?new q(s):s.isEven()?new V(s):new O(s);const o=[],h=i-1,c=(1<<i)-1;let u=3;if(o[1]=e.convert(this),i>1){const t=new x;for(e.sqrTo(o[1],t);u<=c;)o[u]=new x,e.mulTo(t,o[u-2],o[u]),u+=2}let l,f,a=t.t-1,m=!0,d=new x;for(r=I(t[a])-1;a>=0;){for(r>=h?l=t[a]>>r-h&c:(l=(t[a]&(1<<r+1)-1)<<h-r,a>0&&(l|=t[a-1]>>x.DB+r-h)),u=i;0==(1&l);)l>>=1,--u;if((r-=u)<0&&(r+=x.DB,--a),m)o[l].copyTo(n),m=!1;else{for(;u>1;)e.sqrTo(n,d),e.sqrTo(d,n),u-=2;u>0?e.sqrTo(n,d):(f=n,n=d,d=f),e.mulTo(d,o[l],n)}for(;a>=0&&0==(t[a]&1<<r);)e.sqrTo(n,d),f=n,n=d,d=f,--r<0&&(r=x.DB-1,--a)}return e.revert(n)}gcd(t){let s=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(s.compareTo(i)<0){const t=s;s=i,i=t}let e=s.getLowestSetBit(),r=i.getLowestSetBit();if(r<0)return s;for(e<r&&(r=e),r>0&&(s.rShiftTo(r,s),i.rShiftTo(r,i));s.signum()>0;)(e=s.getLowestSetBit())>0&&s.rShiftTo(e,s),(e=i.getLowestSetBit())>0&&i.rShiftTo(e,i),s.compareTo(i)>=0?(s.subTo(i,s),s.rShiftTo(1,s)):(i.subTo(s,i),i.rShiftTo(1,i));return r>0&&i.lShiftTo(r,i),i}modInt(t){if(t<=0)return 0;const s=x.DV%t;let i=this.s<0?t-1:0;if(this.t>0)if(0===s)i=this[0]%t;else for(let e=this.t-1;e>=0;--e)i=(s*i+this[e])%t;return i}modInverse(t){const s=t.isEven();if(this.isEven()&&s||0===t.signum())return x.ZERO;const i=t.clone(),e=this.clone(),r=new x(1),n=new x(0),o=new x(0),h=new x(1);for(;0!==i.signum();){for(;i.isEven();)i.rShiftTo(1,i),s?(r.isEven()&&n.isEven()||(r.addTo(this,r),n.subTo(t,n)),r.rShiftTo(1,r)):n.isEven()||n.subTo(t,n),n.rShiftTo(1,n);for(;e.isEven();)e.rShiftTo(1,e),s?(o.isEven()&&h.isEven()||(o.addTo(this,o),h.subTo(t,h)),o.rShiftTo(1,o)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);i.compareTo(e)>=0?(i.subTo(e,i),s&&r.subTo(o,r),n.subTo(h,n)):(e.subTo(i,e),s&&o.subTo(r,o),h.subTo(n,h))}return 0!==e.compareTo(x.ONE)?x.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h}isProbablePrime(t){const s=this.abs();let i;if(1===s.t&&s[0]<=x.lowprimes[x.lowprimes.length-1]){for(i=0;i<x.lowprimes.length;++i)if(s[0]===x.lowprimes[i])return!0;return!1}if(s.isEven())return!1;for(i=1;i<x.lowprimes.length;){let t=x.lowprimes[i],e=i+1;for(;e<x.lowprimes.length&&t<x.lplim;)t*=x.lowprimes[e++];for(t=s.modInt(t);i<e;)if(t%x.lowprimes[i++]==0)return!1}return s.millerRabin(t)}millerRabin(t){const s=this.subtract(x.ONE),i=s.getLowestSetBit();if(i<=0)return!1;const e=s.shiftRight(i);(t=t+1>>1)>x.lowprimes.length&&(t=x.lowprimes.length);const r=new x;for(let n=0;n<t;++n){r.fromInt(x.lowprimes[Math.floor(h.random()*x.lowprimes.length)]);let t=r.modPow(e,this);if(0!==t.compareTo(x.ONE)&&0!==t.compareTo(s)){let e=1;for(;e++<i&&0!==t.compareTo(s);)if(t=t.modPowInt(2,this),0===t.compareTo(x.ONE))return!1;if(0!==t.compareTo(s))return!1}}return!0}};let A=x;A.DB=30,A.DM=(1<<30)-1,A.DV=1<<30,A.FV=Math.pow(2,52),A.F1=22,A.F2=8,A.ZERO=new x(0),A.ONE=new x(1),A.lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],A.lplim=(1<<26)/x.lowprimes[x.lowprimes.length-1];const B=[];let R,C;for(R="0".charCodeAt(0),C=0;C<=9;++C)B[R++]=C;for(R="a".charCodeAt(0),C=10;C<36;++C)B[R++]=C;for(R="A".charCodeAt(0),C=10;C<36;++C)B[R++]=C;function E(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function M(t,s){const i=B[t.charCodeAt(s)];return null==i?-1:i}function I(t){let s,i=1;return 0!=(s=t>>>16)&&(t=s,i+=16),0!=(s=t>>8)&&(t=s,i+=8),0!=(s=t>>4)&&(t=s,i+=4),0!=(s=t>>2)&&(t=s,i+=2),0!=(s=t>>1)&&(i+=1),i}class q{constructor(t){this.m=t}convert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}revert(t){return t}reduce(t){t.divRemTo(this.m,void 0,t)}mulTo(t,s,i){t.multiplyTo(s,i),this.reduce(i)}sqrTo(t,s){t.squareTo(s),this.reduce(s)}}class O{constructor(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<A.DB-15)-1,this.mt2=2*t.t}convert(t){const s=new A;return t.abs().dlShiftTo(this.m.t,s),s.divRemTo(this.m,void 0,s),t.s<0&&s.compareTo(A.ZERO)>0&&this.m.subTo(s,s),s}revert(t){const s=new A;return t.copyTo(s),this.reduce(s),s}reduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(let s=0;s<this.m.t;++s){let i=32767&t[s];const e=i*this.mpl+((i*this.mph+(t[s]>>15)*this.mpl&this.um)<<15)&A.DM;for(i=s+this.m.t,t[i]+=this.m.am(0,e,t,s,0,this.m.t);t[i]>=A.DV;)t[i]-=A.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}sqrTo(t,s){t.squareTo(s),this.reduce(s)}mulTo(t,s,i){t.multiplyTo(s,i),this.reduce(i)}}function P(t){if(0===t)return-1;let s=0;return 0==(65535&t)&&(t>>=16,s+=16),0==(255&t)&&(t>>=8,s+=8),0==(15&t)&&(t>>=4,s+=4),0==(3&t)&&(t>>=2,s+=2),0==(1&t)&&++s,s}function N(t){let s=0;for(;0!==t;)t&=t-1,++s;return s}class K{constructor(){this.convert=k,this.revert=k,this.reduce=()=>{}}mulTo(t,s,i){t.multiplyTo(s,i)}sqrTo(t,s){t.squareTo(s)}}function k(t){return t}class V{constructor(t){this.r2=new A,this.q3=new A,A.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}convert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;{const s=new A;return t.copyTo(s),this.reduce(s),s}}revert(t){return t}reduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}sqrTo(t,s){t.squareTo(s),this.reduce(s)}mulTo(t,s,i){t.multiplyTo(s,i),this.reduce(i)}}const L={hex:t=>function(t){function s(t,s){const i=(65535&t)+(65535&s);return(t>>16)+(s>>16)+(i>>16)<<16|65535&i}function i(t,s){return t>>>s|t<<32-s}function e(t,s){return t>>>s}function r(t,s,i){return t&s^~t&i}function n(t,s,i){return t&s^t&i^s&i}function o(t){return i(t,2)^i(t,13)^i(t,22)}function h(t){return i(t,6)^i(t,11)^i(t,25)}function c(t){return i(t,7)^i(t,18)^e(t,3)}return function(t){const s="0123456789abcdef";let i="";for(let e=0;e<4*t.length;e++)i+=s.charAt(t[e>>2]>>8*(3-e%4)+4&15)+s.charAt(t[e>>2]>>8*(3-e%4)&15);return i}(function(t,u){const l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],a=new Array(64);let m,d,p,g,b,S,T,w,y,v;t[u>>5]|=128<<24-u%32,t[15+(u+64>>9<<4)]=u;for(let x=0;x<t.length;x+=16){m=f[0],d=f[1],p=f[2],g=f[3],b=f[4],S=f[5],T=f[6],w=f[7];for(let u=0;u<64;u++)a[u]=u<16?t[u+x]:s(s(s(i(D=a[u-2],17)^i(D,19)^e(D,10),a[u-7]),c(a[u-15])),a[u-16]),y=s(s(s(s(w,h(b)),r(b,S,T)),l[u]),a[u]),v=s(o(m),n(m,d,p)),w=T,T=S,S=b,b=s(g,y),g=p,p=d,d=m,m=s(y,v);f[0]=s(m,f[0]),f[1]=s(d,f[1]),f[2]=s(p,f[2]),f[3]=s(g,f[3]),f[4]=s(b,f[4]),f[5]=s(S,f[5]),f[6]=s(T,f[6]),f[7]=s(w,f[7])}var D;return f}(function(t){const s=[];for(let i=0;i<8*t.length;i+=8)s[i>>5]|=(255&t.charCodeAt(i/8))<<24-i%32;return s}(t=F(t)),8*t.length))}(t)};const _={hex:t=>function(t){function s(t,s){return t<<s|t>>>32-s}function i(t){let s,i="";for(let e=7;e>=0;e--)s=t>>>4*e&15,i+=s.toString(16);return i}let e,r,n;const o=new Array(80);let h,c,u,l,f,a,m=1732584193,d=4023233417,p=2562383102,g=271733878,b=3285377520;const S=(t=F(t)).length,T=[];for(r=0;r<S-3;r+=4)n=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),T.push(n);switch(S%4){case 0:r=2147483648;break;case 1:r=t.charCodeAt(S-1)<<24|8388608;break;case 2:r=t.charCodeAt(S-2)<<24|t.charCodeAt(S-1)<<16|32768;break;case 3:r=t.charCodeAt(S-3)<<24|t.charCodeAt(S-2)<<16|t.charCodeAt(S-1)<<8|128}for(T.push(r);T.length%16!=14;)T.push(0);for(T.push(S>>>29),T.push(S<<3&4294967295),e=0;e<T.length;e+=16){for(r=0;r<16;r++)o[r]=T[e+r];for(r=16;r<=79;r++)o[r]=s(o[r-3]^o[r-8]^o[r-14]^o[r-16],1);for(h=m,c=d,u=p,l=g,f=b,r=0;r<=19;r++)a=s(h,5)+(c&u|~c&l)+f+o[r]+1518500249&4294967295,f=l,l=u,u=s(c,30),c=h,h=a;for(r=20;r<=39;r++)a=s(h,5)+(c^u^l)+f+o[r]+1859775393&4294967295,f=l,l=u,u=s(c,30),c=h,h=a;for(r=40;r<=59;r++)a=s(h,5)+(c&u|c&l|u&l)+f+o[r]+2400959708&4294967295,f=l,l=u,u=s(c,30),c=h,h=a;for(r=60;r<=79;r++)a=s(h,5)+(c^u^l)+f+o[r]+3395469782&4294967295,f=l,l=u,u=s(c,30),c=h,h=a;m=m+h&4294967295,d=d+c&4294967295,p=p+u&4294967295,g=g+l&4294967295,b=b+f&4294967295}return(i(m)+i(d)+i(p)+i(g)+i(b)).toLowerCase()}(t)};function j(t){function s(t,s){return t<<s|t>>>32-s}function i(t,s){const i=2147483648&t,e=2147483648&s,r=1073741824&t,n=1073741824&s,o=(1073741823&t)+(1073741823&s);return r&n?2147483648^o^i^e:r|n?1073741824&o?3221225472^o^i^e:1073741824^o^i^e:o^i^e}function e(t,e,r,n,o,h,c){return t=i(t,i(i(function(t,s,i){return t&s|~t&i}(e,r,n),o),c)),i(s(t,h),e)}function r(t,e,r,n,o,h,c){return t=i(t,i(i(function(t,s,i){return t&i|s&~i}(e,r,n),o),c)),i(s(t,h),e)}function n(t,e,r,n,o,h,c){return t=i(t,i(i(function(t,s,i){return t^s^i}(e,r,n),o),c)),i(s(t,h),e)}function o(t,e,r,n,o,h,c){return t=i(t,i(i(function(t,s,i){return s^(t|~i)}(e,r,n),o),c)),i(s(t,h),e)}function h(t){let s,i,e="",r="";for(i=0;i<=3;i++)s=t>>>8*i&255,r="0"+s.toString(16),e+=r.substr(r.length-2,2);return e}let c,u,l,f,a,m,d,p,g;const b=function(t){let s;const i=t.length,e=i+8,r=16*((e-e%64)/64+1),n=Array(r-1);let o=0,h=0;for(;h<i;)s=(h-h%4)/4,o=h%4*8,n[s]=n[s]|t.charCodeAt(h)<<o,h++;return s=(h-h%4)/4,o=h%4*8,n[s]=n[s]|128<<o,n[r-2]=i<<3,n[r-1]=i>>>29,n}(t=F(t));for(m=1732584193,d=4023233417,p=2562383102,g=271733878,c=0;c<b.length;c+=16)u=m,l=d,f=p,a=g,m=e(m,d,p,g,b[c+0],7,3614090360),g=e(g,m,d,p,b[c+1],12,3905402710),p=e(p,g,m,d,b[c+2],17,606105819),d=e(d,p,g,m,b[c+3],22,3250441966),m=e(m,d,p,g,b[c+4],7,4118548399),g=e(g,m,d,p,b[c+5],12,1200080426),p=e(p,g,m,d,b[c+6],17,2821735955),d=e(d,p,g,m,b[c+7],22,4249261313),m=e(m,d,p,g,b[c+8],7,1770035416),g=e(g,m,d,p,b[c+9],12,2336552879),p=e(p,g,m,d,b[c+10],17,4294925233),d=e(d,p,g,m,b[c+11],22,2304563134),m=e(m,d,p,g,b[c+12],7,1804603682),g=e(g,m,d,p,b[c+13],12,4254626195),p=e(p,g,m,d,b[c+14],17,2792965006),d=e(d,p,g,m,b[c+15],22,1236535329),m=r(m,d,p,g,b[c+1],5,4129170786),g=r(g,m,d,p,b[c+6],9,3225465664),p=r(p,g,m,d,b[c+11],14,643717713),d=r(d,p,g,m,b[c+0],20,3921069994),m=r(m,d,p,g,b[c+5],5,3593408605),g=r(g,m,d,p,b[c+10],9,38016083),p=r(p,g,m,d,b[c+15],14,3634488961),d=r(d,p,g,m,b[c+4],20,3889429448),m=r(m,d,p,g,b[c+9],5,568446438),g=r(g,m,d,p,b[c+14],9,3275163606),p=r(p,g,m,d,b[c+3],14,4107603335),d=r(d,p,g,m,b[c+8],20,1163531501),m=r(m,d,p,g,b[c+13],5,2850285829),g=r(g,m,d,p,b[c+2],9,4243563512),p=r(p,g,m,d,b[c+7],14,1735328473),d=r(d,p,g,m,b[c+12],20,2368359562),m=n(m,d,p,g,b[c+5],4,4294588738),g=n(g,m,d,p,b[c+8],11,2272392833),p=n(p,g,m,d,b[c+11],16,1839030562),d=n(d,p,g,m,b[c+14],23,4259657740),m=n(m,d,p,g,b[c+1],4,2763975236),g=n(g,m,d,p,b[c+4],11,1272893353),p=n(p,g,m,d,b[c+7],16,4139469664),d=n(d,p,g,m,b[c+10],23,3200236656),m=n(m,d,p,g,b[c+13],4,681279174),g=n(g,m,d,p,b[c+0],11,3936430074),p=n(p,g,m,d,b[c+3],16,3572445317),d=n(d,p,g,m,b[c+6],23,76029189),m=n(m,d,p,g,b[c+9],4,3654602809),g=n(g,m,d,p,b[c+12],11,3873151461),p=n(p,g,m,d,b[c+15],16,530742520),d=n(d,p,g,m,b[c+2],23,3299628645),m=o(m,d,p,g,b[c+0],6,4096336452),g=o(g,m,d,p,b[c+7],10,1126891415),p=o(p,g,m,d,b[c+14],15,2878612391),d=o(d,p,g,m,b[c+5],21,4237533241),m=o(m,d,p,g,b[c+12],6,1700485571),g=o(g,m,d,p,b[c+3],10,2399980690),p=o(p,g,m,d,b[c+10],15,4293915773),d=o(d,p,g,m,b[c+1],21,2240044497),m=o(m,d,p,g,b[c+8],6,1873313359),g=o(g,m,d,p,b[c+15],10,4264355552),p=o(p,g,m,d,b[c+6],15,2734768916),d=o(d,p,g,m,b[c+13],21,1309151649),m=o(m,d,p,g,b[c+4],6,4149444226),g=o(g,m,d,p,b[c+11],10,3174756917),p=o(p,g,m,d,b[c+2],15,718787259),d=o(d,p,g,m,b[c+9],21,3951481745),m=i(m,u),d=i(d,l),p=i(p,f),g=i(g,a);return(h(m)+h(d)+h(p)+h(g)).toLowerCase()}function F(t){t=t.replace(/\r\n/g,"\n");let s="";for(let i=0;i<t.length;i++){const e=t.charCodeAt(i);e<128?s+=String.fromCharCode(e):e>127&&e<2048?(s+=String.fromCharCode(e>>6|192),s+=String.fromCharCode(63&e|128)):(s+=String.fromCharCode(e>>12|224),s+=String.fromCharCode(e>>6&63|128),s+=String.fromCharCode(63&e|128))}return s}function Z(t,s){return new A(t,s)}function U(t,s){if(s<t.length+11)throw"Message too long for RSA (n="+s+", l="+t.length+")";const i=[];let e=t.length-1;for(;e>=0&&s>0;){const r=t.charCodeAt(e--);r<128?i[--s]=r:r>127&&r<2048?(i[--s]=63&r|128,i[--s]=r>>6|192):(i[--s]=63&r|128,i[--s]=r>>6&63|128,i[--s]=r>>12|224)}i[--s]=0;const r=new T,n=[];for(;s>2;){for(n[0]=0;0===n[0];)r.nextBytes(n);i[--s]=n[0]}return i[--s]=2,i[--s]=0,new A(i)}class z{constructor(){this.n=new A,this.e=0,this.d=new A,this.p=new A,this.q=new A,this.dmp1=new A,this.dmq1=new A,this.coeff=new A,this.signString=G,this.signStringWithSHA1=Q,this.signStringWithSHA256=Y,this.verifyHexSignatureForMessage=st,this.verifyString=it}setPublic(t,s){if(!t||!s)throw"Invalid RSA public key";this.n=Z(t,16),this.e=parseInt(s,16)}doPublic(t){return t.modPowInt(this.e,this.n)}encrypt(t){const s=U(t,this.n.bitLength()+7>>3),i=this.doPublic(s).toString(16);return 0==(1&i.length)?i:"0"+i}setPrivate(t,s,i){if(!(!t&&!s&&t.length>0&&s.length>0))throw"Invalid RSA private key";this.n=Z(t,16),this.e=parseInt(s,16),this.d=Z(i,16)}setPrivateEx(t,s,i,e,r,n,o,h){if(!(!t&&!s&&t.length>0&&s.length>0))throw new Error("Invalid RSA private key");this.n=Z(t,16),this.e=parseInt(s,16),this.d=Z(i,16),this.p=Z(e,16),this.q=Z(r,16),this.dmp1=Z(n,16),this.dmq1=Z(o,16),this.coeff=Z(h,16)}generate(t,s){const i=new a,e=t>>1;this.e=parseInt(s,16);const r=new A(s,16);for(;;){for(;this.p=new A(t-e,1,i),0!==this.p.subtract(A.ONE).gcd(r).compareTo(A.ONE)||!this.p.isProbablePrime(10););for(;this.q=new A(e,1,i),0!==this.q.subtract(A.ONE).gcd(r).compareTo(A.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){const t=this.p;this.p=this.q,this.q=t}const s=this.p.subtract(A.ONE),n=this.q.subtract(A.ONE),o=s.multiply(n);if(0===o.gcd(r).compareTo(A.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(o),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(n),this.coeff=this.q.modInverse(this.p);break}}}doPrivate(t){if(!this.p||!this.q)return t.modPow(this.d,this.n);let s=t.mod(this.p).modPow(this.dmp1,this.p);const i=t.mod(this.q).modPow(this.dmq1,this.q);for(;s.compareTo(i)<0;)s=s.add(this.p);return s.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}decrypt(t){const s=Z(t,16),i=this.doPrivate(s);return i instanceof A?H(i,this.n.bitLength()+7>>3):null}toJSON(){return JSON.stringify({coeff:this.coeff.toString(16),d:this.d.toString(16),dmp1:this.dmp1.toString(16),dmq1:this.dmq1.toString(16),e:this.e.toString(16),n:this.n.toString(16),p:this.p.toString(16),q:this.q.toString(16)})}static parse(t){const s="string"==typeof t?JSON.parse(t):t;if(!s)return null;const i=new z;return i.setPrivateEx(s.n,s.e,s.d,s.p,s.q,s.dmp1,s.dmq1,s.coeff),i}}function H(t,s){const i=t.toByteArray();let e=0;for(;e<i.length&&0===i[e];)++e;if(i.length-e!=s-1||2!==i[e])return null;for(++e;0!==i[e];)if(++e>=i.length)return null;let r="";for(;++e<i.length;){const t=255&i[e];t<128?r+=String.fromCharCode(t):t>191&&t<224?(r+=String.fromCharCode((31&t)<<6|63&i[e+1]),++e):(r+=String.fromCharCode((15&t)<<12|(63&i[e+1])<<6|63&i[e+2]),e+=2)}return r}const J={sha1:"3021300906052b0e03021a05000414",sha256:"3031300d060960864801650304020105000420"},X={sha1:_.hex,sha256:L.hex};function W(t,s,i){const e=s/4,r=(0,X[i])(t),n="0001",o="00"+J[i]+r;let h="";const c=e-n.length-o.length;for(let u=0;u<c;u+=2)h+="ff";return n+h+o}function G(t,s){const i=Z(W(t,this.n.bitLength(),s),16);return this.doPrivate(i).toString(16)}function Q(t){const s=Z(W(t,this.n.bitLength(),"sha1"),16);return this.doPrivate(s).toString(16)}function Y(t){const s=Z(W(t,this.n.bitLength(),"sha256"),16);return this.doPrivate(s).toString(16)}function $(t,s,i){return function(t,s,i){const e=new z;return e.setPublic(s,i),e.doPublic(t)}(t,s,i).toString(16).replace(/^1f+00/,"")}function tt(t){for(const s in J){const i=J[s],e=i.length;if(t.substring(0,e)===i)return[s,t.substring(e)]}return[]}function st(t,s){return function(t,s,i,e){const r=tt($(s,i,e));if(0===r.length)return!1;const n=r[0];return r[1]===(0,X[n])(t)}(t,Z(s,16),this.n.toString(16),this.e.toString(16))}function it(t,s){const i=Z(s=s.replace(/[ \n]+/g,""),16),e=tt(this.doPublic(i).toString(16).replace(/^1f+00/,""));if(0===e.length)return!1;const r=e[0];return e[1]===(0,X[r])(t)}const et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rt="::52cee64bb3a38f6403386519a39ac91c::";s.Init();t.BigInteger=A,t.MD5=j,t.RSAKey=z,t.SecureRandom=T,t.SeededRandom=a,t.byte2Hex=function(t){return t<16?"0"+t.toString(16):t.toString(16)},t.cryptico=class{static b256to64(t){let s,i,e=0,r="",n=0;const o=t.length;for(i=0;i<o;i++)s=t.charCodeAt(i),0===n?(r+=et.charAt(s>>2&63),e=(3&s)<<4):1===n?(r+=et.charAt(e|s>>4&15),e=(15&s)<<2):2===n&&(r+=et.charAt(e|s>>6&3),r+=et.charAt(63&s)),n+=1,3===n&&(n=0);return n>0&&(r+=et.charAt(e),r+="="),1===n&&(r+="="),r}static b64to256(t){let s,i,e="",r=0,n=0;const o=t.length;for(i=0;i<o;i++)s=et.indexOf(t.charAt(i)),s>=0&&(r&&(e+=String.fromCharCode(n|s>>6-r&255)),r=r+2&7,n=s<<r&255);return e}static b16to64(t){let s,i,e="";for(t.length%2==1&&(t="0"+t),s=0;s+3<=t.length;s+=3)i=parseInt(t.substring(s,s+3),16),e+=et.charAt(i>>6)+et.charAt(63&i);for(s+1===t.length?(i=parseInt(t.substring(s,s+1),16),e+=et.charAt(i<<2)):s+2===t.length&&(i=parseInt(t.substring(s,s+2),16),e+=et.charAt(i>>2)+et.charAt((3&i)<<4));(3&e.length)>0;)e+="=";return e}static b64to16(t){let s,i="",e=0,r=0;for(s=0;s<t.length&&"="!==t.charAt(s);++s){const n=et.indexOf(t.charAt(s));n<0||(0===e?(i+=E(n>>2),r=3&n,e=1):1===e?(i+=E(r<<2|n>>4),r=15&n,e=2):2===e?(i+=E(r),i+=E(n>>2),r=3&n,e=3):(i+=E(r<<2|n>>4),i+=E(15&n),e=0))}return 1===e&&(i+=E(r<<2)),i}static string2bytes(t){const s=[];for(let i=0;i<t.length;i++)s.push(t.charCodeAt(i));return s}static bytes2string(t){let s="";for(let i=0;i<t.length;i++)s+=String.fromCharCode(t[i]);return s}static utf82string(t){return unescape(encodeURIComponent(t))}static string2utf8(t){return decodeURIComponent(escape(t))}static utf82bytes(t){const s=unescape(encodeURIComponent(t));return this.string2bytes(s)}static bytes2utf8(t){const s=this.bytes2string(t);return decodeURIComponent(escape(s))}static blockXOR(t,s){const i=new Array(16);for(let e=0;e<16;e++)i[e]=t[e]^s[e];return i}static blockIV(){const t=new T,s=new Array(16);return t.nextBytes(s),s}static pad16(t){const s=t.slice(0),i=(16-t.length%16)%16;for(let e=t.length;e<t.length+i;e++)s.push(0);return s}static depad(t){let s=t.slice(0);for(;0===s[s.length-1];)s=s.slice(0,s.length-1);return s}static encryptAESCBC(t,i){const e=i.slice(0);s.ExpandKey(e);let r=this.utf82bytes(t);r=this.pad16(r);let n=this.blockIV();for(let h=0;h<r.length/16;h++){let t=r.slice(16*h,16*h+16);const i=n.slice(16*h,16*h+16);t=this.blockXOR(i,t),s.Encrypt(t,e),n=n.concat(t)}const o=this.bytes2string(n);return this.b256to64(o)}static decryptAESCBC(t,i){const e=i.slice(0);s.ExpandKey(e);const r=this.b64to256(t),n=this.string2bytes(r);let o=[];for(let h=1;h<n.length/16;h++){let t=n.slice(16*h,16*h+16);const i=n.slice(16*(h-1),16*(h-1)+16);s.Decrypt(t,e),t=this.blockXOR(i,t),o=o.concat(t)}return o=this.depad(o),this.bytes2utf8(o)}static wrap60(t){let s="";for(let i=0;i<t.length;i++)i%60==0&&0!==i&&(s+="\n"),s+=t[i];return s}static generateAESKey(){const t=new Array(32);return(new T).nextBytes(t),t}static generateRSAKey(t,s){h.seedrandom(L.hex(t));const i=new z;return i.generate(s,"03"),i}static publicKeyString(t){return this.b16to64(t.n.toString(16))}static publicKeyID(t){return j(t)}static publicKeyFromString(t){const s=this.b64to16(t.split("|")[0]),i=new z;return i.setPublic(s,"03"),i}static encrypt(t,s,i){{let r="";const n=this.generateAESKey();try{const t=this.publicKeyFromString(s);r+=this.b16to64(t.encrypt(this.bytes2string(n)))+"?"}catch(e){return{status:"Invalid public key"}}if(i){const s=this.sign(t,i);t+=rt,t+=this.publicKeyString(i),t+=rt,t+=s}return r+=this.encryptAESCBC(t,n),{status:"success",cipher:r}}}static decrypt(t,s){const i=t.split("?"),e=s.decrypt(this.b64to16(i[0]));if(null==e)return{status:"failure"};const r=this.string2bytes(e),n=this.decryptAESCBC(i[1],r).split(rt);return n.length>1?this._confirm(n):{status:"success",plaintext:n[0],signature:"unsigned"}}static sign(t,s){return this.b16to64(s.signString(t,"sha256"))}static verify(t){const s=this._confirm(t);return"success"===s.status&&"verified"===s.signature}static _confirm(t){if(3===t.length){const s=this.publicKeyFromString(t[1]),i=this.b64to16(t[2]);return s.verifyString(t[0],i)?{status:"success",plaintext:t[0],signature:"verified",publicKeyString:this.publicKeyString(s)}:{status:"success",plaintext:t[0],signature:"forged",publicKeyString:this.publicKeyString(s)}}return{status:"failure"}}},t.int2char=E,t.linebrk=function(t,s){let i="",e=0;for(;e+s<t.length;)i+=t.substring(e,e+s)+"\n",e+=s;return i+t.substring(e,t.length)},t.math=h,t.op_and=w,t.op_andnot=D,t.op_or=y,t.op_xor=v,t.parseBigInt=Z,t.pkcs1pad2=U,t.pkcs1unpad2=H,t.sha1=_,t.sha256=L,Object.defineProperty(t,"__esModule",{value:!0}),t[Symbol.toStringTag]="Module"}));
//# sourceMappingURL=cryptico.umd.js.map
