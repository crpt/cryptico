<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <script language="JavaScript" type="text/javascript" src="../dist/cryptico.umd.js"></script>
        <script>

        function print(string)
        {
            document.write(string + "\n\n");
        }

        print("<h1>Unsigned:</h1>");

        var PassPhrase = "The Moon is a Harsh Mistress.";
        var Bits = 512;

        print("Matt's passphrase: " + PassPhrase);
        print("Bit length: " + Bits);

        var MattsRSAkey = cryptico.generateRSAKey(PassPhrase, Bits);
        var MattsPublicKeyString = cryptico.publicKeyString(MattsRSAkey);

        print("Matt's public key string:");
        print(MattsPublicKeyString);

        var PlainText = "Matt, I need you to encrypt UTF-8 strings which may include 中文字符.";

        print("Sam's message: " + PlainText);

        var EncryptionResult = cryptico.encrypt(PlainText, MattsPublicKeyString);

        print("The encrypted message:");
        print(EncryptionResult.cipher);

        var DecryptionResult = cryptico.decrypt(EncryptionResult.cipher, MattsRSAkey);

        print("The decrypted message:");
        print(DecryptionResult.plaintext);
        print("DecryptionResult.signature: " + DecryptionResult.signature);

        print("<h1>Signed, good signature:</h1>");

        var PassPhrase = "There Ain't No Such Thing As A Free Lunch.";
        var Bits = 512;
        var SamsRSAkey = cryptico.generateRSAKey(PassPhrase, Bits);
        var PlainText = "Matt, I need you to encrypt UTF-8 strings which may include 中文字符.";
        var EncryptionResult = cryptico.encrypt(PlainText, MattsPublicKeyString, SamsRSAkey);

        print("Sam's public key ID: " + cryptico.publicKeyID(cryptico.publicKeyString(SamsRSAkey)));

        print("The encrypted message:");
        print(EncryptionResult.cipher);

        var DecryptionResult = cryptico.decrypt(EncryptionResult.cipher, MattsRSAkey);

        print("The decrypted message:");
        print(DecryptionResult.plaintext);

        print("DecryptionResult.signature: " + DecryptionResult.signature);

        print("The signature public key string:");
        print(DecryptionResult.publicKeyString);

        print("The signature public key ID:");
        print(cryptico.publicKeyID(DecryptionResult.publicKeyString));



        /* TODO: fix forged signature test */
        print("<h1>Signed, forged signature:</h1>");

        var ForgersRSAkey = cryptico.generateRSAKey(PassPhrase, Bits);
        var ForgedEncryptionResult = cryptico.encrypt(PlainText, MattsPublicKeyString, ForgersRSAkey);

        print("Forger's public key ID: " + cryptico.publicKeyID(cryptico.publicKeyString(ForgersRSAkey)));

        EncryptionResult.cipher = ForgedEncryptionResult.cipher

        print("The encrypted message:");
        print(EncryptionResult.cipher);

        var DecryptionResult = cryptico.decrypt(EncryptionResult.cipher, MattsRSAkey);

        print("The decrypted message:");
        print(DecryptionResult.plaintext);

        print("DecryptionResult.signature: " + DecryptionResult.signature);

        print("The signature public key string:");
        print(DecryptionResult.publicKeyString);

        print("The signature public key ID:");
        print(cryptico.publicKeyID(DecryptionResult.publicKeyString));

        </script>
    </head>
    <body style="font-family: monospace; white-space:pre;">
    </body>
</html>
